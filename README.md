# 《安全多方计算——可证明安全视角》

张秉晟  殷泽原  任奎  **编著**

v1.2.0，2025年7月

---

## 修改说明

### v1.2.0

1. 增加致谢内容。
2. 第9.4.1.3节，Page 185：增加脚注17.
3. 第9.4.1.4节，Page 188，第二段补充说明：$B_k, C_k$ 用 $\mathsf{pk}_V$ 加密（因此它们属于 $\mathbb{G}_V$）。
4. 第9.4.1.4节，Page 190，图 9.34，步骤2：以 $\mathsf{Enc}_{\mathsf{pk}_i}(x_{k, i})$ 为输入 -> 以 $\{ \mathsf{Enc}_{\mathsf{pk}_i}(x_{k, i}) \}_{k=1}^u$ 为输入。
5. 第9.4.1.4节，Page 190，图 9.35，步骤2：以 $C_k, \mathsf{Enc}_{\mathsf{pk}_i}(x_k), \mathsf{Enc}_{\mathsf{pk}_j}(y_k)$ 作为输入 -> 以 $\mathsf{Enc}_{\mathsf{pk}_i}(x_k), \mathsf{Enc}_{\mathsf{pk}_j}(y_k), C_k$ 作为输入。
6. 第9.4.2.2节，Page 199，图 9.44，**初始化**步骤3：增加“令 $\Delta = \sum_{i=1}^n \Delta_i$.”
7. 第9.4.2.2节，Page 199，图 9.44，**秘密分享对**步骤4：记录敌手 $\mathcal{S}$ 发送的 $\boldsymbol{\delta}_1, \dots, \boldsymbol{\delta}_n \in (\mathbb{F}_p)^s$ -> 记录敌手 $\mathcal{S}$ 发送的 $\boldsymbol{\delta}, \boldsymbol{\delta}_1, \dots, \boldsymbol{\delta}_n \in (\mathbb{F}_p)^s$.

## 目录

#### 前言

#### 1. 引言

1.1 安全多方计算

&emsp;1.1.1 问题描述

&emsp;1.1.2 安全加法与投票

&emsp;1.1.3 安全乘法与配对

&emsp;1.1.4 如果参与方不遵守指令？

&emsp;1.1.5 通用解决方案

1.2 内容概览

#### 2. 基础知识

2.1 现代密码学与可证明安全

&emsp;2.1.1 形式化的定义

&emsp;2.1.2 精确的假设

&emsp;2.1.3 严格的安全性证明

2.2 基本术语和符号

2.3 基础原语

&emsp;2.3.1 门限秘密分享

&emsp;2.3.2 哈希函数与随机谕示机

&emsp;2.3.3 伪随机数生成器

&emsp;2.3.4 对称加密

&emsp;2.3.5 （信息论一次性）消息认证码

&emsp;2.3.6 承诺

&emsp;2.3.7 茫然传输

#### 3. 一个安全多方计算协议的例子

3.1 Shamir秘密分享

&emsp;3.1.1 拉格朗日插值法

&emsp;3.1.2 计算示例

3.2 半诚实安全的电路计算协议

&emsp;3.2.1 算术电路

&emsp;3.2.2 协议描述

&emsp;3.2.3 安全性分析

&emsp;3.2.4 计算示例

#### 4. 安全模型

4.1 隐私性与恶意安全性

&emsp;4.1.1 定义隐私性

&emsp;4.1.2 定义恶意安全性

&emsp;4.1.3 同时获得隐私性和恶意安全性

&emsp;4.1.4 通用可组合框架概述

4.2 形式化模型——通用可组合框架

&emsp;4.2.1 真实协议及其运行

&emsp;&emsp;4.2.1.1 真实协议的运行机制

&emsp;&emsp;4.2.1.2 敌手与诚实方的通信

&emsp;&emsp;4.2.1.3 平凡敌手

&emsp;&emsp;4.2.1.4 运行时间考虑

&emsp;4.2.2 理想协议及其运行

&emsp;&emsp;4.2.2.1 理想协议的运行机制

&emsp;&emsp;4.2.2.2 运行时间考虑

&emsp;4.2.3 安全函数计算的理想功能

&emsp;&emsp;4.2.3.1 概率功能

&emsp;4.2.4 UC-安全实现

&emsp;4.2.5 UC-安全实现的效果

&emsp;&emsp;4.2.5.1 并发组合的安全性

&emsp;&emsp;4.2.5.2 子协议组合的安全性

&emsp;&emsp;4.2.5.3 安全实现的传递性

&emsp;4.2.6 定义半诚实安全性

&emsp;&emsp;4.2.6.1 定义受限框架

&emsp;&emsp;4.2.6.2 安全定义及其效果

&emsp;4.2.7 不同类型的攻陷方式

&emsp;&emsp;4.2.7.1 适应性攻陷

&emsp;&emsp;4.2.7.2 可移动攻陷与主动安全

#### 5. 茫然传输和茫然传输扩展

5.1 关于OT的一些结论

&emsp;5.1.1 不存在信息论安全的两方OT协议

&emsp;5.1.2 OT变种

&emsp;5.1.3 一些其他结论

5.2 基于DDH假设的OT协议（半诚实安全）

&emsp;5.2.1 协议描述

&emsp;5.2.2 安全性的直观说明

&emsp;5.2.3 安全性证明

5.3 三方OT协议（恶意安全）

&emsp;5.3.1 协议描述

&emsp;5.3.2 安全性的直观说明

&emsp;5.3.3 安全性证明

5.4 IKNP OT扩展协议

&emsp;5.4.1 协议描述

&emsp;5.4.2 安全性的直观说明

&emsp;5.4.3 安全性证明

5.5 拓展阅读

#### 6. 基于线性秘密分享的协议

6.1 BGW协议（半诚实安全）

&emsp;6.1.1 协议描述

&emsp;6.1.2 安全性证明

6.2 GMW协议

&emsp;6.2.1 两方布尔电路GMW协议

&emsp;&emsp;6.2.1.1 协议描述

&emsp;6.2.2 多方布尔电路GMW协议

&emsp;&emsp;6.2.2.1 协议描述

&emsp;&emsp;6.2.2.2 安全性证明

&emsp;6.2.3 多方算术电路GMW协议

&emsp;&emsp;6.2.3.1 协议描述

&emsp;&emsp;6.2.3.2 安全性证明

#### 7. 通过Beaver三元组实现MPC

7.1 基于Beaver三元组的MPC协议

&emsp;7.1.1 Beaver三元组

&emsp;7.1.2 协议描述

&emsp;7.1.3 安全性证明

7.2 Beaver三元组的生成

&emsp;7.2.1 基于可信第三方的方式

&emsp;7.2.2 分布式生成方式

#### 8. 基于混淆电路的协议

8.1 姚氏混淆电路协议

&emsp;8.1.1 直观思想

&emsp;8.1.2 协议描述

&emsp;8.1.3 安全性分析

&emsp;8.1.4 独立模型

&emsp;8.1.5 安全性证明

&emsp;8.1.6 混淆电路的优化

8.2 BMR协议

&emsp;8.2.1 直观思想

&emsp;8.2.2 协议描述

&emsp;8.2.3 安全性分析

#### 9. 恶意安全性

9.1 GMW编译器

9.2 切分选择

&emsp;9.2.1 直观思想

&emsp;9.2.2 LP11协议

&emsp;&emsp;9.2.2.1 切分选择OT

&emsp;&emsp;9.2.2.2 输入一致性零知识证明

&emsp;&emsp;9.2.2.3 协议描述

&emsp;9.2.3 安全性证明

9.3 BGW协议（恶意安全）

&emsp;9.3.1 直观思想

&emsp;9.3.2 准备工作——Shamir 秘密分享的性质与引理证明

&emsp;9.3.3 BGW可验证秘密分享

&emsp;9.3.4 乘法协议

&emsp;&emsp;9.3.4.1 定义并行可验证秘密分享理想功能 $\mathcal{F}^n_\mathsf{VSS}$

&emsp;&emsp;9.3.4.2 实现矩阵乘法理想功能 $\mathcal{F}^A_\mathsf{mat}$

&emsp;&emsp;9.3.4.3 实现子份额秘密分享理想功能 
$\mathcal{F}^\mathsf{subshare}_\mathsf{VSS}$

&emsp;&emsp;9.3.4.4 实现多项式求值理想功能 $\mathcal{F}_\mathsf{eval}$

&emsp;&emsp;9.3.4.5 实现乘积子份额秘密分享理想功能 $\mathcal{F}^\mathsf{mult}_\mathsf{VSS}$

&emsp;&emsp;9.3.4.6 实现乘法理想功能 $\mathcal{F}_\mathsf{mult}$

&emsp;9.3.5 $\{\mathcal{F}^n_\mathsf{VSS}, \mathcal{F}_\mathsf{mult}\}$-混合模型下的安全计算协议

9.4 BDOZ协议和SPDZ协议

&emsp;9.4.1 BDOZ协议

&emsp;&emsp;9.4.1.1 直观思想

&emsp;&emsp;9.4.1.2 协议描述

&emsp;&emsp;9.4.1.3 安全性证明

&emsp;&emsp;9.4.1.4 预处理阶段的实现

&emsp;9.4.2 SPDZ协议

&emsp;&emsp;9.4.2.1 直观思想

&emsp;&emsp;9.4.2.2 协议描述

&emsp;&emsp;9.4.2.3 安全性证明

&emsp;&emsp;9.4.2.4 *预处理阶段的实现

#### 后记

---

## 作者简介

### 张秉晟
![张秉晟照片](bingsheng.jpg)

浙江大学计算机科学与技术学院/网络空间安全学院“百人计划”研究员、博士生导师，国家级青年人才项目获得者、科技部重大科研项目首席科学家、中国密码学会密码数学理论专业委员会委员、SIGSAC China委员、CCF高级会员、CCF数据治理发展委员会执行委员；在学术方面，张秉晟近年来在国际高水平期刊会议上发表学术论文70余篇：包括Eurocrypt、Asiacrypt、PKC、Usenix Security、S&P、CCS、NDSS、AAAI、INFOCOM等密码学和安全领域顶级会议，撰写专著《隐私保护机器学习》，以主编身份在第三届全球数字贸易博览会上发布《2024全球隐私计算报告》。回国前，张秉晟曾任英国兰卡斯特大学助理教授、信息安全学科带头人、网络安全系主任。近年来，张秉晟主要致力于我国的国际标准推进工作，任IEEE CES/SC P2859《多模态融合》标准化工作组副主席、IEEE CES/SC P2842《安全多方计算实践指南》工作组秘书，ISO/IEC 27565《基于零知识证明的隐私保护指南》国际标准主编，ISO/IEC 27574《脑机接口隐私》国际标准联合编辑等；获2024年度全国网络安全标准化技术委员会标准化工作先进个人奖。

### 殷泽原
![殷泽原照片](zeyuan.jpg)

2021年获得山东大学计算机科学与技术专业学士学位，目前在浙江大学网络空间安全学院攻读博士学位，师从张秉晟研究员。殷泽原的研究方向包括密码学、安全多方计算、区块链等。他在CCF A类期刊上发表论文一篇。

### 任奎
![任奎照片](kuiren.png)

浙江大学求是讲席教授，ACM、CCF和IEEE会士。现任浙江大学计算机科学与技术学院院长，浙江大学网络空间安全学院院长，区块链与数据安全全国重点实验室副主任，浙江大学校学术委员会委员。并曾担任纽约州立大学布法罗分校冠名教授及普适安全与隐私实验室主任。任奎教授主要从事数据安全与隐私保护、人工智能安全、物联网安全等领域的研究。他先后主持和参与了科技部、国家自然科学基金委员会、浙江省领军型创新团队、美国国家科学基金会、美国能源部、香港研究资助局、韩国国家研究基金会、阿里巴巴、蚂蚁金服、华为、亚马逊等机构和公司的多项科研项目，研究成果广泛应用在包括阿里、蚂蚁金服、华为等公司的产品和服务中。任奎教授获得了包括浙江大学首届国华杰出学者奖，IEEE通信学会CISTC技术成就奖 、纽约州立大学校长杰出研究奖 、美国国家自然科学基金青年职业奖在内的一系列奖项。任奎教授发表了500余篇同行评议的期刊与会议文章，获得了包括ACSAC'22、IEEE ICDCS’20、ACM MobiSys’20、IEEE INFOCOM’20、IEEE Globecom’19、中国密码学会’18、ACM/IEEE IWQoS’17，IEEE ICNP’11等在内的多篇最佳论文和时间考验论文奖。他的H-Index为100，文章总引用次数超过55,000次，并连续入选科睿唯安高被引科学家。任奎教授同时担任教育部科学技术委员会委员、高等学校教学指导委员会委员、ACM亚洲计算机与通信安全会议指导委员会委员、ACM中国安全分会主席以及浙江省海高会副会长。任奎教授担任了多个ACM和IEEE国际权威期刊编委，及国际一流会议主席或共同主席。